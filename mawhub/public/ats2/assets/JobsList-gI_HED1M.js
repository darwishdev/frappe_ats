var B=($,S,g)=>new Promise((m,r)=>{var j=h=>{try{y(g.next(h))}catch(c){r(c)}},x=h=>{try{y(g.throw(h))}catch(c){r(c)}},y=h=>h.done?m(h.value):Promise.resolve(h.value).then(j,x);y((g=g.apply($,S)).next())});import{_ as re,r as k,g as E,h as ce,w as F,b as a,d as _,f as P,u,i as I,a as d,F as N,j as L,k as z,t as p,D as ue,o as n,l as pe,c as q,m as C,n as fe,S as O,p as me,q as ve}from"./index-BzDh_yLH.js";import{c as T,J as H}from"./createLucideIcon-ChQj8lUH.js";/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=T("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=T("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=T("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=T("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),ge={class:"jdd-content"},ke={key:0,class:"jdd-loading"},$e={key:1,class:"jdd-sections"},je={key:0,class:"jdd-details-card"},we={class:"jdd-details-grid"},xe={key:0,class:"jdd-detail-item jdd-detail-full"},Je={class:"jdd-detail-icon"},Ve={class:"jdd-detail-content"},Ce={class:"jdd-detail-value"},Se={class:"jdd-detail-item"},De={class:"jdd-detail-icon"},Fe={class:"jdd-detail-content"},Ue={class:"jdd-detail-value"},ze={class:"jdd-detail-item"},Ne={class:"jdd-detail-icon"},Le={class:"jdd-detail-content"},Te={class:"jdd-detail-value"},Ae={class:"jdd-detail-item jdd-detail-full"},Me={class:"jdd-detail-icon"},Be={class:"jdd-detail-content"},Oe={class:"jdd-detail-value jdd-detail-description"},Pe={key:1,class:"jdd-section"},Ie={class:"jdd-section-header"},Re={class:"jdd-section-title"},Ee={key:0,class:"jdd-section-description"},qe={key:1,class:"jdd-bullet-points"},He={key:2,class:"jdd-empty"},Ge={class:"w-full flex justify-end"},We={__name:"JobDescriptionDialog",props:{modelValue:{type:Boolean,default:!1},parsedData:{type:Object,default:()=>({})},isLoading:{type:Boolean,default:!1}},emits:["update:modelValue","create"],setup($,{emit:S}){const g=$,m=S,r=k(g.modelValue);E(()=>g.modelValue,c=>{r.value=c}),E(r,c=>{m("update:modelValue",c)});const j=()=>{r.value=!1},x=()=>{m("create",g.parsedData),j()},y=c=>c.replace(/([A-Z])/g," $1").replace(/_/g," ").trim().split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()).join(" "),h=(c,l,i="SAR")=>{const f=b=>b?new Intl.NumberFormat("en-US").format(b):"";return c&&l?`${f(c)} - ${f(l)} ${i}`:c?`From ${f(c)} ${i}`:l?`Up to ${f(l)} ${i}`:"Not specified"};return(c,l)=>(n(),ce(u(ue),{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=i=>r.value=i),options:{title:"Parsed Job Description",size:"5xl"}},{"body-content":F(()=>[a("div",ge,[$.isLoading?(n(),d("div",ke,[...l[1]||(l[1]=[a("div",{class:"spinner"},null,-1),a("p",null,"Parsing job description...",-1)])])):Object.keys($.parsedData).length>0?(n(),d("div",$e,[(n(!0),d(N,null,L($.parsedData,(i,f)=>(n(),d("div",{key:f},[f==="job_opening_details"?(n(),d("div",je,[l[6]||(l[6]=a("h3",{class:"jdd-details-title"},"Job Opening",-1)),a("div",we,[i.job_title?(n(),d("div",xe,[a("div",Je,[_(u(he),{size:24})]),a("div",Ve,[l[2]||(l[2]=a("div",{class:"jdd-detail-label"},"Job Title",-1)),a("div",Ce,p(i.job_title),1)])])):z("",!0),a("div",Se,[a("div",De,[_(u(be),{size:24})]),a("div",Fe,[l[3]||(l[3]=a("div",{class:"jdd-detail-label"},"Location",-1)),a("div",Ue,p(i.location||"N/A"),1)])]),a("div",ze,[a("div",Ne,[_(u(_e),{size:24})]),a("div",Le,[l[4]||(l[4]=a("div",{class:"jdd-detail-label"},"Salary Range",-1)),a("div",Te,p(h(i.lower_range,i.upper_range,i.currency)||"N/A"),1)])]),a("div",Ae,[a("div",Me,[_(u(ye),{size:24})]),a("div",Be,[l[5]||(l[5]=a("div",{class:"jdd-detail-label"},"Description",-1)),a("div",Oe,p(i.description||"N/A"),1)])])])])):(n(),d("div",Pe,[a("div",Ie,[a("h3",Re,p(y(f)),1)]),i.description?(n(),d("div",Ee,p(i.description),1)):z("",!0),i.bullet_points&&i.bullet_points.length>0?(n(),d("div",qe,[a("ul",null,[(n(!0),d(N,null,L(i.bullet_points,(b,A)=>(n(),d("li",{key:A},p(b),1))),128))])])):z("",!0)]))]))),128))])):(n(),d("div",He,[...l[7]||(l[7]=[a("p",null,"No data parsed yet",-1)])]))])]),actions:F(()=>[a("div",Ge,[_(u(I),{variant:"solid",onClick:x,disabled:$.isLoading||Object.keys($.parsedData).length===0},{default:F(()=>[...l[8]||(l[8]=[P(" Create Job ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["modelValue"]))}},Xe=re(We,[["__scopeId","data-v-e10f16e4"]]),Ze={class:"jc-page"},Qe={class:"jc-toolbar"},Ye={class:"jc-search"},Ke={class:"jc-filters"},et={class:"flex justify-end gap-3 items-center w-full my-4"},tt={key:0,class:"text-center py-8 text-gray-500"},at={key:1,class:"text-center py-8 text-red-500"},st={key:2,class:"jc-list"},lt=["data-job"],ot={class:"jc-card-head"},nt=["onClick"],it={class:"jc-subtitle"},dt={class:"jc-actions"},rt=["onClick"],ct=["onClick"],ut={key:0,class:"jc-pipeline"},pt=["title"],ft={class:"jc-stage-count"},mt={class:"jc-stage-label"},vt={class:"jc-card-foot"},_t={key:0,class:"jc-warn"},ht={key:1},yt={key:3,class:"jc-empty"},$t={__name:"JobsList",setup($,{expose:S}){const g=ve(),m=pe();H.init(q);const r=k({search:"",department:"",location:"",group:"",includeDrafts:!0}),j=k([]),x=k([]),y=k(null),h=k(!1),c=k(0),l=k(!1),i=k(!1),f=k(null),b=q({url:"mawhub.job_opening_list",auto:!0,onSuccess(t){j.value=A(t||[]),V()}});function A(t){return t.map(e=>{const s=new Map;e.steps&&Array.isArray(e.steps)&&e.steps.forEach(v=>{const D=`${v.step_id}-${v.step_name}`;s.has(D)||s.set(D,{id:v.step_id,label:v.step_name,count:0}),s.get(D).count+=v.candidate_count||0});const o=Array.from(s.values()).sort((v,D)=>v.id-D.id),w=parseInt(e.candidate_count)||0,U=e.publish===1,J=e.docstatus===0;return{name:e.name,title:e.designation||"Untitled Position",department:e.department||"Not Specified",location:e.location||"Not Specified",work_mode:e.employment_type||"Full-time",is_published:U,is_draft:J,route:e.route||"",stages:o,candidates_total:w,candidates_active:w,last_candidate_on:e.posted_on,group:e.department||null}})}const G=C(()=>[...new Set(j.value.map(t=>t.department).filter(Boolean))].sort()),W=C(()=>[...new Set(j.value.map(t=>t.location).filter(Boolean))].sort()),X=C(()=>[...new Set(j.value.map(t=>t.group).filter(Boolean))].sort()),Z=C(()=>[{label:"All departments",value:""},...G.value.map(t=>({label:t,value:t}))]),Q=C(()=>[{label:"All locations",value:""},...W.value.map(t=>({label:t,value:t}))]),Y=C(()=>[{label:"No group applied",value:""},...X.value.map(t=>({label:t,value:t}))]);function V(){const t=r.value;x.value=j.value.filter(e=>{if(!t.includeDrafts&&e.is_draft||t.department&&e.department!==t.department||t.location&&e.location!==t.location||t.group&&e.group!==t.group)return!1;if(t.search){const s=t.search.toLowerCase();if(!`${e.title} ${e.department} ${e.location} ${e.work_mode}`.toLowerCase().includes(s))return!1}return!0})}let R=null;function K(){clearTimeout(R),R=setTimeout(V,200)}function ee(t){return t>=1e3?`${(t/1e3).toFixed(1)}k`:t.toString()}function te(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(e){return t}}function ae(t){g.push({name:"JobDetails",params:{jobId:t}})}function se(t){const e=`http://localhost:8001/${t.route}`;navigator.clipboard.writeText(e).then(()=>{m.success("Job link copied to clipboard!")}).catch(()=>{m.error("Failed to copy link")})}function le(t){console.log("Finding candidates for:",t)}function oe(){y.value&&y.value.click()}function ne(t){return B(this,null,function*(){var U;const e=t.target.files[0];if(!e)return;if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(e.type)){m.error("Please upload a PDF or Word document");return}const o=10*1024*1024;if(e.size>o){m.error("File size must be less than 10MB");return}const w=new FormData;w.append("file",e),w.append("is_private",1);try{h.value=!0,c.value=0;const J=yield fetch("/api/method/upload_file",{method:"POST",headers:{"X-Frappe-CSRF-Token":((U=window.frappe)==null?void 0:U.csrf_token)||""},body:w});if(!J.ok)throw new Error("Upload failed");const v=yield J.json();if(v.message&&v.message.file_url)c.value=100,m.success("Job description uploaded successfully"),console.log("File Uploaded:",v.message.file_url),yield ie(v.message.file_url,v.message.name);else throw new Error("Invalid response from server")}catch(J){console.error("Upload failed:",J),m.error(`Upload failed: ${J.message||"Unknown error"}`)}finally{h.value=!1,c.value=0,y.value&&(y.value.value="")}})}function ie(t,e){return B(this,null,function*(){try{m.info("Parsing job description..."),f.value={},l.value=!0,i.value=!0;const s=yield H.parseJobOpening({path:`./erpdev.talplatform.ai${t}`,file_name:e},o=>{if(console.log("Job parsing step:",o),o&&o.event=="error"){m.error(`Job parsing error: ${o.data||"Unknown error"}`),l.value=!1,i.value=!1;return}if(!(!o||!o.data)&&!(!o||!o.data)){if(l.value=!1,o.event=="final"){m.success("Job description parsed successfully!");return}if(o.data.titles){o.data.titles.forEach(w=>{f.value[w]||(f.value[w]={description:"",bullet_points:[]})});return}f.value[Object.keys(o.data)[0]]=o.data[Object.keys(o.data)[0]],console.log("parsedJobData:",f.value)}})}catch(s){console.error("Job parsing failed:",s),m.error(`Job parsing failed: ${s.message||"Unknown error"}`),i.value=!1,f.value=null}finally{}})}function de(t){M()}function M(){b.fetch()}return S({reload:M}),(t,e)=>(n(),d("div",Ze,[a("div",Qe,[a("div",Ye,[_(u(fe),{modelValue:r.value.search,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value.search=s),type:"text",size:"sm",variant:"subtle",placeholder:"Start typing to search jobs...",onInput:K},null,8,["modelValue"])]),a("div",Ke,[_(u(O),{class:"w-48",placeholder:"Select Department",modelValue:r.value.department,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.department=s),options:Z.value,onChange:V},null,8,["modelValue","options"]),_(u(O),{class:"w-48",placeholder:"Select Location",modelValue:r.value.location,"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.location=s),options:Q.value,onChange:V},null,8,["modelValue","options"]),_(u(O),{class:"w-48",placeholder:"Select Group",modelValue:r.value.group,"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.group=s),options:Y.value,onChange:V},null,8,["modelValue","options"]),_(u(me),{size:"sm",modelValue:r.value.includeDrafts,"onUpdate:modelValue":e[4]||(e[4]=s=>r.value.includeDrafts=s),label:"Include draft jobs",onChange:V},null,8,["modelValue"])])]),a("div",et,[_(u(I),{theme:"gray",size:"md",class:"w-40",disabled:u(b).loading,onClick:M},{default:F(()=>[P(p(u(b).loading?"Refreshing...":"Refresh"),1)]),_:1},8,["disabled"]),_(u(I),{theme:"gray",variant:"solid",size:"md",class:"w-40",onClick:oe},{default:F(()=>[...e[6]||(e[6]=[P(" New Job ",-1)])]),_:1})]),u(b).loading?(n(),d("div",tt," Loading jobs... ")):u(b).error?(n(),d("div",at," Error loading jobs: "+p(u(b).error),1)):x.value.length>0?(n(),d("div",st,[(n(!0),d(N,null,L(x.value,s=>(n(),d("div",{key:s.name,class:"jc-card","data-job":s.name},[a("div",ot,[a("div",null,[a("div",{class:"jc-title",onClick:o=>ae(s.name)},p(s.title),9,nt),a("div",it,p(s.department)+" Â· "+p(s.work_mode)+" Â· "+p(s.location),1)]),a("div",dt,[a("button",{class:"btn btn-default btn-sm",onClick:o=>se(s)}," ðŸ“‹ Copy Link ",8,rt),a("button",{class:"btn btn-default btn-sm",onClick:o=>le(s.name)}," Find Candidates ",8,ct)])]),s.stages.length>0?(n(),d("div",ut,[(n(!0),d(N,null,L(s.stages.slice(0,12),o=>(n(),d("div",{key:`${s.name}-${o.id}`,class:"jc-stage",title:o.label},[a("div",ft,p(ee(o.count)),1),a("div",mt,p(o.label),1)],8,pt))),128))])):z("",!0),a("div",vt,[s.is_published?(n(),d("div",ht)):(n(),d("div",_t,[...e[7]||(e[7]=[a("span",{style:{"font-size":"16px"}},"âœ•",-1),a("span",null,"This job is not published on your careers page or on any job boards",-1)])])),a("div",null," Candidates: "+p(s.candidates_total)+" total Â· "+p(s.candidates_active)+" active in pipeline Â· Last candidate on "+p(te(s.last_candidate_on)),1)])],8,lt))),128))])):(n(),d("div",yt,"No jobs found.")),a("input",{ref_key:"jobFileInput",ref:y,type:"file",accept:".pdf,.doc,.docx",style:{display:"none"},onChange:ne},null,544),_(Xe,{modelValue:i.value,"onUpdate:modelValue":e[5]||(e[5]=s=>i.value=s),"parsed-data":f.value,"is-loading":l.value,onCreate:de},null,8,["modelValue","parsed-data","is-loading"])]))}};export{$t as default};
//# sourceMappingURL=JobsList-gI_HED1M.js.map
